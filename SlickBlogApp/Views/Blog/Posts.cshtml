@model SlickBlogApp.ViewModels.CpPosts
@using SlickBlogApp.Helpers
@{
    ViewBag.Title = Model.Title;
    Layout = "~/Views/Shared/_LayoutCP.cshtml";
}
@section style {
<link href="@Url.Content("~/Content/themes/base/jquery.ui.all.css")" rel="stylesheet"/>
}
@section scripts {
<script type="text/javascript">
    var $j = jQuery;
    $j("#dialog-confirm").dialog({
        resizable: false,
        height: 140,
        modal: true,
        autoOpen: false,
        draggable: false,
        height: 'auto',
        buttons: {
            Continue: function () {
                var path = $(this).data('link').href; // Get the stored result
                $(location).attr('href', path);
                window.location.href = a.href;
            },
            Cancel: function () {
                $j(this).dialog("close");
            }
        }
    });
$j('.btn-danger').click(function () {
    var a = this;
    event.preventDefault();
    $("#dialog-confirm")
        .data('link', a)  // The important part .data() method
        .dialog('open');
    
});
</script>
}
<h2>@Model.Title</h2>
<table class="table table-striped table-bordered">
    <colgroup>
        <col class="span1">
        <col class="span7">
    </colgroup>
    <thead>
        <tr>
            <th style="width: 40%">Posts</th>
            <th style="width: 40%"><a class="btn btn-primary" href="@Url.Content("~/Blog/" + Model.Address + "/PostEditor")">
                New post</a></th>
            <th style="width: 20%"></th>
        </tr>
    </thead>
    <tbody>
        @if (Model.Posts.Count() > 0)
        {
            foreach (var post in Model.Posts)
            {
            <tr>
                <td>@post.Title</td>
                <td>
                    @post.PostDate
                </td>
                <td><a class="btn btn-mini btn-info" href="@Url.Content("~/Blog/" + post.Blog.Address + "/Details/" + post.PostId)">
                    View</a> <a class="btn btn-mini" href="@Url.Content("~/Blog/" + post.Blog.Address + "/PostEditor/" + post.PostId)">
                        Edit</a> <a class="btn btn-mini btn-danger" href="@Url.Content("~/Blog/" + post.Blog.Address + "/DeletePost/" + post.PostId)">
                        Delete</a></td>
            </tr>
            }
        }
        else
        {
            <tr>
                <td>No Posts yet</td>
                <td></td>
                <td></td>
            </tr>
        }
    </tbody>
</table>
@Html.PostPaging(Model)
<div id="dialog-confirm" title="Delete post">
	<p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>Are you sure that you want to permanently delete selected post?</p>
</div>
